<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://unpkg.com/photoswipe@5/dist/photoswipe.css">
  <style>

  /* ギャラリー全体のスタイル */
  .gallery {
    display: flex; /* 子要素を横並びに表示 */
    flex-wrap: wrap; /* 子要素が画面幅を超えた場合に折り返し */
    justify-content: center; /* 子要素を中央揃え */
    gap: 10px; /* 子要素間のスペース */
    padding: 20px; /* 内側の余白を設定 */
    margin-top: 56px; /* 上部の余白を追加 */
    margin-bottom: 1000px; /* 上部の余白を追加 */
  }

  /* ギャラリー内のリンク要素のスタイル */
  .gallery a {
    width: 18%; /* 横幅を親要素の18%に設定 */
    max-width: 100px; /* 横幅の最大値を100pxに設定 */
    text-decoration: none; /* テキストの下線を削除 */
  }

  /* ギャラリー内の画像のスタイル */
  .gallery img {
    width: 100%; /* 親要素の幅に合わせる */
    height: auto; /* アスペクト比を維持して高さを自動調整 */
    border-radius: 5px; /* 角を丸める */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* 画像に影を追加 */
    transition: transform 0.3s, box-shadow 0.3s; /* ホバー時のアニメーション */
  }

  /* 画像ホバー時のスタイル */
  .gallery img:hover {
    transform: scale(1.1); /* 拡大 */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* 影を強調 */
  }

  /* 全体ギャラリー要素の追加スタイル */
  .image-gallery {
    display: block; /* 子要素をブロック要素として表示 */
    overflow: auto; /* スクロール可能にする */
    margin-bottom: 1000px; /* 下部の余白を大きく確保 */
  }

  /* メディアクエリ：画面幅768px以下の場合 */
  @media (max-width: 768px) {
    .gallery a {
      width: 24%; /* 横幅を親要素の24%に設定 */
    }
  }

  /* メディアクエリ：画面幅480px以下の場合 */
  @media (max-width: 480px) {
    .gallery a {
      width: 30%; /* 横幅を親要素の30%に設定 */
    }
  }

  /* PhotoSwipeカスタムキャプションのスタイル */
  .pswp__custom-caption {
    color: white !important; /* キャプションのテキスト色を白に設定 */
    text-align: center !important; /* キャプションを中央揃え */
    padding: 5px; /* キャプションの内側の余白 */
    position: absolute; /* 親要素に相対的に配置 */
    bottom: 30px; /* 親要素の下部から30pxの位置 */
    width: 100%; /* キャプションの幅を全幅に設定 */
    z-index: 1000; /* 他の要素より前面に表示 */
    visibility: visible; /* 常に表示 */
  }

  /* PhotoSwipeカウンターを非表示にする */
  .pswp__counter {
    display: none; /* カウンターを非表示 */
  }
</style>
</head>
<body>

<nav>
  <a href="index.html">キャラ</a>
  <a href="illustrations.html">絵</a>
  <a href="gallery.html">漫画</a>
  <a href="story.html">小説</a>
  <a href="blog.html">日記</a>
</nav>

<div class="gallery"></div>

<script type="module">
  import PhotoSwipeLightbox from 'https://unpkg.com/photoswipe@5/dist/photoswipe-lightbox.esm.min.js';

  const images = [
    { src: 'images/1.png', width: 1000, height: 1000, date: '2024-11-01' },
    { src: 'images/2.png', width: 1000, height: 1000, date: '2024-11-02' },
    { src: 'images/3.png', width: 1000, height: 1000, date: '2024-11-03' },
    { src: 'images/4.png', width: 1000, height: 1000, date: '2024-11-04' },
    { src: 'images/5.png', width: 1000, height: 1000, date: '2024-11-05' },
    { src: 'images/6.png', width: 1000, height: 1000, date: '2024-11-06' },
    { src: 'images/7.png', width: 1000, height: 1000, date: '2024-11-07' },
  ];

  const galleryElement = document.querySelector('.gallery');
  images.reverse().forEach(({ src, width, height, date }) => {
    galleryElement.innerHTML += `
      <a href="${src}" data-pswp-width="${width}" data-pswp-height="${height}">
        <img src="${src}" alt="イラスト">
        <span class="hidden-caption-content" style="display:none;">${date}</span>
      </a>`;
  });

  const lightbox = new PhotoSwipeLightbox({
    gallery: '.gallery',
    children: 'a',
    pswpModule: () => import('https://unpkg.com/photoswipe@5/dist/photoswipe.esm.min.js'),
    loop: false, // ループを無効に設定
  });

  lightbox.on('uiRegister', () => {
    lightbox.pswp.ui.registerElement({
      name: 'custom-counter',
      order: 5,
      isButton: false,
      appendTo: 'bar',
      html: '',
      onInit: (el, pswp) => {
        Object.assign(el.style, {
          color: 'white', fontSize: '15px', fontFamily: 'Arial, sans-serif', fontWeight: 'bold',
          position: 'relative', top: '20px', left: '30px', padding: '2px',
          webkitTextStroke: '1px rgba(128, 128, 128, 0.8)', textStroke: '1px rgba(128, 128, 128, 0.8)',
        });
        pswp.on('change', () => {
          const total = pswp.getNumItems();
          const index = total - pswp.currIndex;
          el.innerHTML = `${index} / ${total}`;
        });
      },
    });

    lightbox.pswp.ui.registerElement({
      name: 'custom-caption',
      order: 9,
      isButton: false,
      appendTo: 'wrapper',
      html: '',
      onInit: (el, pswp) => {
        pswp.on('change', () => {
          const caption = pswp.currSlide?.data.element.querySelector('.hidden-caption-content');
          el.innerHTML = caption ? caption.textContent : 'キャプションなし';
        });
      },
    });

    const style = document.createElement('style');
    style.innerHTML = `.pswp__bg { background-color: #ADD8E6 !important; }`;
    document.head.appendChild(style);
  });

  lightbox.init();
</script>

<footer>
  © irorinri. All Rights Reserved.
</footer>

</body>
</html>
