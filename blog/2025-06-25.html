<!-- Like Button Area -->
<div id="like-area" style="text-align:center; margin-top: 1.5em; font-family: sans-serif;">
  <button onclick="addLike()" style="
    padding: 0.4em 1em;
    font-size: 0.9em;
    border-radius: 999px;
    border: 1px solid #ccc;
    background: rgba(255,255,255,0.4);
    backdrop-filter: blur(4px);
    color: #333;
    cursor: pointer;
    transition: background 0.3s;
  " onmouseover="this.style.background='#eee'" onmouseout="this.style.background='rgba(255,255,255,0.4)'">
    üëç Like this post
  </button>
  <p id="like-count" style="margin-top: 0.5em; font-size: 0.85em; color: #666;">
    Likes: <span id="like-number">...</span>
  </p>
</div>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, doc, getDoc, setDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCtBvct6BKEazVzERc-FNAY8w3hCO8rNU",
    authDomain: "like-counter-blog.firebaseapp.com",
    projectId: "like-counter-blog",
    storageBucket: "like-counter-blog.appspot.com",
    messagingSenderId: "571743964148",
    appId: "1:571743964148:web:423ef8234b2b89e2841b3",
    measurementId: "G-S14T0V9VC0"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Unique blog ID for this post
  const blogId = "2025-06-25";  // ‚Üê „Åì„Åì„Å†„ÅëÊØéË®ò‰∫ãÂ§â„Åà„ÇãÔºÅ

  const docRef = doc(db, "blogLikes", blogId);

  // Safe DOM access after load
  document.addEventListener("DOMContentLoaded", async () => {
    try {
      const docSnap = await getDoc(docRef);
      if (docSnap.exists()) {
        document.getElementById("like-number").textContent = docSnap.data().count;
      } else {
        await setDoc(docRef, { count: 0 });
        document.getElementById("like-number").textContent = "0";
      }
    } catch (e) {
      document.getElementById("like-number").textContent = "Error";
      console.error("Firestore read error:", e);
    }
  });

  // Like button function
  window.addLike = async function () {
    try {
      await updateDoc(docRef, { count: increment(1) });
      const newSnap = await getDoc(docRef);
      document.getElementById("like-number").textContent = newSnap.data().count;
    } catch (e) {
      console.error("Like failed:", e);
    }
  };
</script>
